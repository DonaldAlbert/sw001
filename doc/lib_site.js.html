<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lib/site.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: lib/site.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

/**
* Code responsible for handling the site configurations of the CMS.
*
* @module site
*/


var fs = require('fs')
    , async = require('async')
    , appManager = require('./site-app-manager');


module.exports.Site = Site;



/**
 * Class representing a site served by the CMS.
 *
 * @class Site
 * @param {string} path - The site's directory
 */
function Site(path) {
    /**
     * The name of the file where the settings of the site are found.
     * @constant {string}
     */
    this.SETTINGS_FILENAME = 'settings.js';

    /**
     * 
     */
    this._httpGenerator = null;

    /**
     * The name of the site. It is extracted from the last part of the
     * path passed to the constructor.
     * @member {string}
     */
    this.name = path.slice(path.lastIndexOf('/'));

    /**
     * The root of the site's files.
     * @member {string}
     */
    this.siteRoot = path;

    /**
     * The absolute path of the settings file for the site.
     * @member {string}
     * @default this.siteRoot+'/'+this.SETTINGS_FILENAME
     */
    this.settingsFile = this.siteRoot+'/'+this.SETTINGS_FILENAME;

    /**
     * An object that holds all the settings of the site. This object
     * is loaded from the settings file.
     * @member {object}
     */
    this.settings = {};

    this._loadSettings = function() {
        var exists;
            
        console.info('Creating ' + this.name);
        this.settings = require(this.settingsFile);
        console.info(this.settingsFile + ' found: \x1b[92m \x1b[1m ture \x1b[0m');
    };

    this._init = function() {
        this._loadSettings();
        this._httpGenerator = new appManager.SiteAppManager(this);
        
    };

    /**
     * This method returns a generator callback to be used in a koa
     * application.
     * 
     * @returns {function} A generator callback.
     */
    this.getCallback = function() {
        return this._httpGenerator.getCallback();
    };

    // Initialization code.
    this._init();
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-bootstrap.html">bootstrap</a></li><li><a href="module-generator-manager.html">generator-manager</a></li><li><a href="module-site.html">site</a></li><li><a href="module-site-app-manager.html">site-app-manager</a></li><li><a href="module-system.html">system</a></li></ul><h3>Classes</h3><ul><li><a href="module-generator-manager-GeneratorManager.html">GeneratorManager</a></li><li><a href="module-generator-manager-OrderedManp.html">OrderedManp</a></li><li><a href="module-site-app-manager-SiteAppManager.html">SiteAppManager</a></li><li><a href="module-site-Site.html">Site</a></li><li><a href="Server.html">Server</a></li><li><a href="ServerLayer.html">ServerLayer</a></li></ul><h3>Global</h3><ul><li><a href="global.html#appendSite">appendSite</a></li><li><a href="global.html#funcy">funcy</a></li><li><a href="global.html#removeSite">removeSite</a></li><li><a href="global.html#start">start</a></li><li><a href="global.html#stop">stop</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Mon Sep 21 2015 16:41:01 GMT+0300 (EEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
